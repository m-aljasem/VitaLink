import{a as le}from"./chunk-B3MTCGZB.js";import"./chunk-7VI3B7OV.js";import{a as re,p as oe,r as ae}from"./chunk-ZJ66G7QH.js";import{b as ne}from"./chunk-FEUMV7UB.js";import{$ as A,A as m,Aa as $,Ba as z,Ea as J,F as d,Fa as K,G as x,Ga as Q,H as R,Ha as X,I as N,Ia as Z,J as v,Ja as ee,K as C,L as E,M as p,N as _,O as P,Oa as te,P as O,Pa as ie,Q as D,_ as V,ba as B,ea as G,ha as F,i as g,ia as W,j as u,l as r,n as S,o as k,oa as L,p as w,pa as j,qa as U,r as c,ra as H,s as a,sa as q,t as o,u as y,y as I,z as h,za as Y}from"./chunk-IPUYINSA.js";import"./chunk-QFN5WVFN.js";import"./chunk-7KGURMOZ.js";import"./chunk-C6GHFGSM.js";import"./chunk-4BHFLD23.js";import"./chunk-MFJQPCIH.js";import"./chunk-PGY34PD4.js";import"./chunk-GYLY2RJE.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-2F44PKVT.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{a as b,b as M,g as f}from"./chunk-2R6CW7ES.js";function se(l,s){if(l&1){let i=I();a(0,"ion-item")(1,"ion-label")(2,"h3"),d(3),o(),a(4,"p"),d(5),o()(),a(6,"ion-checkbox",10),h("ionChange",function(){let e=g(i).$implicit,n=m(2);return u(n.toggleReminder(e))}),o(),a(7,"ion-button",11),h("click",function(){let e=g(i).$implicit,n=m(2);return u(n.deleteReminder(e))}),y(8,"ion-icon",12),o()()}if(l&2){let i=s.$implicit;r(3),x(i.title),r(2),N("",i.local_time," - ",i.days==null?null:i.days.join(", ")),r(),c("checked",i.enabled)}}function de(l,s){if(l&1&&(a(0,"ion-list",8),w(1,se,9,4,"ion-item",9),o()),l&2){let i=m();r(),c("ngForOf",i.reminders)}}function me(l,s){l&1&&(a(0,"ion-text",13),d(1," No reminders yet "),o())}function ce(l,s){if(l&1){let i=I();a(0,"ion-checkbox",24),h("ionChange",function(){let e=g(i).$implicit,n=m(2);return u(n.toggleDay(e.value))}),d(1),p(2,"translate"),o()}if(l&2){let i=s.$implicit,t=m(2);c("checked",t.newReminder.days==null?null:t.newReminder.days.includes(i.value)),r(),R(" ",_(2,2,i.label)," ")}}function pe(l,s){if(l&1){let i=I();a(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),d(3),p(4,"translate"),o(),a(5,"ion-buttons",14)(6,"ion-button",15),h("click",function(){g(i);let e=m();return u(e.showAddModal=!1)}),d(7),p(8,"translate"),o()()()(),a(9,"ion-content",16)(10,"ion-item")(11,"ion-label",17),d(12),p(13,"translate"),o(),a(14,"ion-input",18),E("ngModelChange",function(e){g(i);let n=m();return C(n.newReminder.title,e)||(n.newReminder.title=e),u(e)}),o()(),a(15,"ion-item")(16,"ion-label",17),d(17),p(18,"translate"),o(),a(19,"ion-datetime",19),E("ngModelChange",function(e){g(i);let n=m();return C(n.newReminder.local_time,e)||(n.newReminder.local_time=e),u(e)}),o()(),a(20,"div",20)(21,"p"),d(22),p(23,"translate"),o(),a(24,"div",21),w(25,ce,3,4,"ion-checkbox",22),o()(),a(26,"ion-button",23),h("click",function(){g(i);let e=m();return u(e.saveReminder())}),d(27),p(28,"translate"),o()()}if(l&2){let i=m();r(3),x(_(4,9,"SETTINGS.ADD_REMINDER")),r(4),x(_(8,11,"COMMON.CLOSE")),r(5),x(_(13,13,"SETTINGS.REMINDER_TITLE")),r(2),v("ngModel",i.newReminder.title),r(3),x(_(18,15,"SETTINGS.TIME")),r(2),v("ngModel",i.newReminder.local_time),r(3),x(_(23,17,"SETTINGS.DAYS")),r(3),c("ngForOf",i.daysOfWeek),r(2),R(" ",_(28,19,"COMMON.SAVE")," ")}}var Ce=(()=>{let s=class s{constructor(t,e,n,T){this.authService=t,this.reminderService=e,this.toastController=n,this.alertController=T,this.reminders=[],this.showAddModal=!1,this.newReminder={title:"",local_time:void 0,days:[],enabled:!0},this.daysOfWeek=[{value:"Mon",label:"SETTINGS.MON"},{value:"Tue",label:"SETTINGS.TUE"},{value:"Wed",label:"SETTINGS.WED"},{value:"Thu",label:"SETTINGS.THU"},{value:"Fri",label:"SETTINGS.FRI"},{value:"Sat",label:"SETTINGS.SAT"},{value:"Sun",label:"SETTINGS.SUN"}],ae({add:re,trash:oe})}ngOnInit(){return f(this,null,function*(){yield this.reminderService.requestPermission(),yield this.loadReminders()})}loadReminders(){return f(this,null,function*(){let t=this.authService.getCurrentUser();if(!t)return;let{data:e}=yield this.reminderService.getReminders(t.id);this.reminders=e||[]})}toggleDay(t){let e=this.newReminder.days||[],n=e.indexOf(t);n>-1?e.splice(n,1):e.push(t),this.newReminder.days=e}saveReminder(){return f(this,null,function*(){if(!this.newReminder.title||!this.newReminder.local_time||!this.newReminder.days?.length){yield(yield this.toastController.create({message:"Please fill all fields",duration:2e3,color:"danger"})).present();return}let t=this.authService.getCurrentUser();if(!t)return;let{error:e}=yield this.reminderService.createReminder(M(b({},this.newReminder),{user_id:t.id}));e?yield(yield this.toastController.create({message:"Failed to create reminder",duration:2e3,color:"danger"})).present():(this.showAddModal=!1,this.newReminder={title:"",local_time:void 0,days:[],enabled:!0},yield this.loadReminders())})}deleteReminder(t){return f(this,null,function*(){yield(yield this.alertController.create({header:"Delete Reminder",message:"Are you sure you want to delete this reminder?",buttons:[{text:"Cancel",role:"cancel"},{text:"Delete",role:"destructive",handler:()=>f(this,null,function*(){yield this.reminderService.deleteReminder(t.id),yield this.loadReminders()})}]})).present()})}toggleReminder(t){return f(this,null,function*(){yield this.reminderService.updateReminder(t.id,{enabled:!t.enabled}),yield this.loadReminders()})}};s.\u0275fac=function(e){return new(e||s)(S(ne),S(le),S(K),S(J))},s.\u0275cmp=k({type:s,selectors:[["app-reminders"]],decls:15,vars:11,consts:[[3,"translucent"],[1,"ion-padding",3,"fullscreen"],[1,"reminders-container"],["expand","block",3,"click"],["name","add","slot","start"],["class","ion-margin-top",4,"ngIf"],["color","medium","class","ion-margin-top",4,"ngIf"],[3,"didDismiss","isOpen"],[1,"ion-margin-top"],[4,"ngFor","ngForOf"],["slot","end",3,"ionChange","checked"],["fill","clear","slot","end",3,"click"],["name","trash","color","danger"],["color","medium",1,"ion-margin-top"],["slot","end"],[3,"click"],[1,"ion-padding"],["position","stacked"],[3,"ngModelChange","ngModel"],["presentation","time",3,"ngModelChange","ngModel"],[1,"days-section"],[1,"days-grid"],[3,"checked","ionChange",4,"ngFor","ngForOf"],["expand","block",1,"ion-margin-top",3,"click"],[3,"ionChange","checked"]],template:function(e,n){e&1&&(a(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),d(3),p(4,"translate"),o()()(),a(5,"ion-content",1)(6,"div",2)(7,"ion-button",3),h("click",function(){return n.showAddModal=!0}),y(8,"ion-icon",4),d(9),p(10,"translate"),o(),w(11,de,2,1,"ion-list",5)(12,me,2,0,"ion-text",6),o(),a(13,"ion-modal",7),h("didDismiss",function(){return n.showAddModal=!1}),w(14,pe,29,21,"ng-template"),o()()),e&2&&(c("translucent",!0),r(3),x(_(4,7,"SETTINGS.REMINDERS")),r(2),c("fullscreen",!0),r(4),R(" ",_(10,9,"SETTINGS.ADD_REMINDER")," "),r(2),c("ngIf",n.reminders.length>0),r(),c("ngIf",n.reminders.length===0),r(),c("isOpen",n.showAddModal))},dependencies:[D,P,O,B,V,A,L,j,$,z,F,W,ee,U,H,q,Q,X,Z,Y,G,ie,te],styles:[".reminders-container[_ngcontent-%COMP%]{max-width:600px;margin:0 auto}.days-section[_ngcontent-%COMP%]{margin:1rem 0}.days-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-weight:500;margin-bottom:.5rem}.days-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:.5rem}"]});let l=s;return l})();export{Ce as RemindersPage};
