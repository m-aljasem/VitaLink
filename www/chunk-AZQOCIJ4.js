import{a as ie}from"./chunk-GCNMMXZU.js";import{a as ee}from"./chunk-5S6NIQFG.js";import{a as te}from"./chunk-ZL5SRYO7.js";import{b as $}from"./chunk-FEUMV7UB.js";import{$ as D,A as c,Aa as z,Ba as J,Ea as Y,F as l,Fa as q,G as p,H as u,I as O,J as w,K as S,L as f,La as Q,M as s,N as d,O as k,Oa as X,P as b,Pa as Z,Q as V,_ as B,ba as A,ea as R,ha as W,i as g,ia as L,j as m,l as n,n as E,o as M,oa as H,p as I,pa as F,qa as G,r as C,ra as j,s as o,sa as U,t as r,y as T,z as h,za as K}from"./chunk-IPUYINSA.js";import"./chunk-QFN5WVFN.js";import"./chunk-7KGURMOZ.js";import"./chunk-C6GHFGSM.js";import"./chunk-4BHFLD23.js";import"./chunk-MFJQPCIH.js";import"./chunk-PGY34PD4.js";import"./chunk-GYLY2RJE.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-2F44PKVT.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{a as N,b as y,g as x}from"./chunk-2R6CW7ES.js";function re(_,v){if(_&1){let t=T();o(0,"ion-item",11),h("click",function(){let e=g(t).$implicit,i=c(2);return m(i.showProviderDetails(e))}),o(1,"ion-label")(2,"h3"),l(3),r(),o(4,"p"),l(5),r(),o(6,"p"),l(7),s(8,"translate"),r()()()}if(_&2){let t=v.$implicit,a=c(2);n(3),O("",t.providerProfile==null?null:t.providerProfile.first_name," ",t.providerProfile==null?null:t.providerProfile.last_name),n(2),p(t.providerProfile==null?null:t.providerProfile.provider_kind),n(2),O("",d(8,5,"CONNECT.ADDED_DATE"),": ",a.formatDate(t.created_at))}}function oe(_,v){if(_&1&&(o(0,"ion-list"),I(1,re,9,7,"ion-item",10),r()),_&2){let t=c();n(),C("ngForOf",t.providers)}}function ae(_,v){_&1&&(o(0,"ion-text",12),l(1),s(2,"translate"),r()),_&2&&(n(),u(" ",d(2,1,"CONNECT.NO_PROVIDERS")," "))}function le(_,v){if(_&1){let t=T();o(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),l(3),s(4,"translate"),r(),o(5,"ion-buttons",13)(6,"ion-button",14),h("click",function(){g(t);let e=c();return m(e.showCodeModal=!1)}),l(7),s(8,"translate"),r()()()(),o(9,"ion-content",15)(10,"p"),l(11),s(12,"translate"),r(),o(13,"app-six-digit-input",16),f("codeChange",function(e){g(t);let i=c();return S(i.code,e)||(i.code=e),m(e)}),h("codeComplete",function(){g(t);let e=c();return m(e.redeemCode())}),r(),o(14,"div",17)(15,"h4"),l(16),s(17,"translate"),r(),o(18,"ion-item")(19,"ion-label"),l(20),s(21,"translate"),r(),o(22,"ion-toggle",18),f("ngModelChange",function(e){g(t);let i=c();return S(i.newProviderSharing.share_bp,e)||(i.newProviderSharing.share_bp=e),m(e)}),r()(),o(23,"ion-item")(24,"ion-label"),l(25),s(26,"translate"),r(),o(27,"ion-toggle",18),f("ngModelChange",function(e){g(t);let i=c();return S(i.newProviderSharing.share_glucose,e)||(i.newProviderSharing.share_glucose=e),m(e)}),r()(),o(28,"ion-item")(29,"ion-label"),l(30),s(31,"translate"),r(),o(32,"ion-toggle",18),f("ngModelChange",function(e){g(t);let i=c();return S(i.newProviderSharing.share_spo2,e)||(i.newProviderSharing.share_spo2=e),m(e)}),r()(),o(33,"ion-item")(34,"ion-label"),l(35),s(36,"translate"),r(),o(37,"ion-toggle",18),f("ngModelChange",function(e){g(t);let i=c();return S(i.newProviderSharing.share_hr,e)||(i.newProviderSharing.share_hr=e),m(e)}),r()(),o(38,"ion-item")(39,"ion-label"),l(40),s(41,"translate"),r(),o(42,"ion-toggle",18),f("ngModelChange",function(e){g(t);let i=c();return S(i.newProviderSharing.share_pain,e)||(i.newProviderSharing.share_pain=e),m(e)}),r()(),o(43,"ion-item")(44,"ion-label"),l(45),s(46,"translate"),r(),o(47,"ion-toggle",18),f("ngModelChange",function(e){g(t);let i=c();return S(i.newProviderSharing.share_weight,e)||(i.newProviderSharing.share_weight=e),m(e)}),r()()(),o(48,"ion-button",19),h("click",function(){g(t);let e=c();return m(e.redeemCode())}),l(49),s(50,"translate"),r()()}if(_&2){let t=c();n(3),p(d(4,19,"CONNECT.ADD_CARETAKER")),n(4),p(d(8,21,"COMMON.CLOSE")),n(4),p(d(12,23,"CONNECT.ENTER_CODE")),n(2),w("code",t.code),n(3),p(d(17,25,"CONNECT.SHARING_OPTIONS")),n(4),p(d(21,27,"CONNECT.SHARE_BP")),n(2),w("ngModel",t.newProviderSharing.share_bp),n(3),p(d(26,29,"CONNECT.SHARE_GLUCOSE")),n(2),w("ngModel",t.newProviderSharing.share_glucose),n(3),p(d(31,31,"CONNECT.SHARE_SPO2")),n(2),w("ngModel",t.newProviderSharing.share_spo2),n(3),p(d(36,33,"CONNECT.SHARE_HR")),n(2),w("ngModel",t.newProviderSharing.share_hr),n(3),p(d(41,35,"CONNECT.SHARE_PAIN")),n(2),w("ngModel",t.newProviderSharing.share_pain),n(3),p(d(46,37,"CONNECT.SHARE_WEIGHT")),n(2),w("ngModel",t.newProviderSharing.share_weight),n(),C("disabled",t.code.length!==6),n(),u(" ",d(50,39,"COMMON.CONFIRM")," ")}}function se(_,v){if(_&1){let t=T();o(0,"ion-content",15)(1,"div",21)(2,"p")(3,"strong"),l(4),s(5,"translate"),r(),l(6),r(),o(7,"p")(8,"strong"),l(9),s(10,"translate"),r(),l(11),r(),o(12,"h4",22),l(13),s(14,"translate"),r(),o(15,"ion-item")(16,"ion-label"),l(17),s(18,"translate"),r(),o(19,"ion-toggle",23),h("ionChange",function(e){g(t);let i=c(2);return m(i.updateSharing(i.selectedProvider.id,"share_bp",e.detail.checked))}),r()(),o(20,"ion-item")(21,"ion-label"),l(22),s(23,"translate"),r(),o(24,"ion-toggle",23),h("ionChange",function(e){g(t);let i=c(2);return m(i.updateSharing(i.selectedProvider.id,"share_glucose",e.detail.checked))}),r()(),o(25,"ion-item")(26,"ion-label"),l(27),s(28,"translate"),r(),o(29,"ion-toggle",23),h("ionChange",function(e){g(t);let i=c(2);return m(i.updateSharing(i.selectedProvider.id,"share_spo2",e.detail.checked))}),r()(),o(30,"ion-item")(31,"ion-label"),l(32),s(33,"translate"),r(),o(34,"ion-toggle",23),h("ionChange",function(e){g(t);let i=c(2);return m(i.updateSharing(i.selectedProvider.id,"share_hr",e.detail.checked))}),r()(),o(35,"ion-item")(36,"ion-label"),l(37),s(38,"translate"),r(),o(39,"ion-toggle",23),h("ionChange",function(e){g(t);let i=c(2);return m(i.updateSharing(i.selectedProvider.id,"share_pain",e.detail.checked))}),r()(),o(40,"ion-item")(41,"ion-label"),l(42),s(43,"translate"),r(),o(44,"ion-toggle",23),h("ionChange",function(e){g(t);let i=c(2);return m(i.updateSharing(i.selectedProvider.id,"share_weight",e.detail.checked))}),r()(),o(45,"ion-button",24),h("click",function(){g(t);let e=c(2);return e.revokeAccess(e.selectedProvider),m(e.showProviderDetail=!1)}),l(46),s(47,"translate"),r()()()}if(_&2){let t=c(2);n(4),u("",d(5,18,"ONBOARDING.PROVIDER_KIND"),":"),n(2),u(" ",t.selectedProvider.providerProfile==null?null:t.selectedProvider.providerProfile.provider_kind),n(3),u("",d(10,20,"CONNECT.ADDED_DATE"),":"),n(2),u(" ",t.formatDate(t.selectedProvider.created_at)),n(2),p(d(14,22,"CONNECT.SHARING_OPTIONS")),n(4),p(d(18,24,"CONNECT.SHARE_BP")),n(2),C("checked",t.selectedProvider.share_bp),n(3),p(d(23,26,"CONNECT.SHARE_GLUCOSE")),n(2),C("checked",t.selectedProvider.share_glucose),n(3),p(d(28,28,"CONNECT.SHARE_SPO2")),n(2),C("checked",t.selectedProvider.share_spo2),n(3),p(d(33,30,"CONNECT.SHARE_HR")),n(2),C("checked",t.selectedProvider.share_hr),n(3),p(d(38,32,"CONNECT.SHARE_PAIN")),n(2),C("checked",t.selectedProvider.share_pain),n(3),p(d(43,34,"CONNECT.SHARE_WEIGHT")),n(2),C("checked",t.selectedProvider.share_weight),n(2),u(" ",d(47,36,"CONNECT.REVOKE")," ")}}function de(_,v){if(_&1){let t=T();o(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),l(3),r(),o(4,"ion-buttons",13)(5,"ion-button",14),h("click",function(){g(t);let e=c();return m(e.showProviderDetail=!1)}),l(6),s(7,"translate"),r()()()(),I(8,se,48,38,"ion-content",20)}if(_&2){let t=c();n(3),O("",t.selectedProvider==null||t.selectedProvider.providerProfile==null?null:t.selectedProvider.providerProfile.first_name," ",t.selectedProvider==null||t.selectedProvider.providerProfile==null?null:t.selectedProvider.providerProfile.last_name),n(3),p(d(7,4,"COMMON.CLOSE")),n(2),C("ngIf",t.selectedProvider)}}var fe=(()=>{let v=class v{constructor(a,e,i,P,ne){this.authService=a,this.sharingService=e,this.profileService=i,this.toastController=P,this.alertController=ne,this.providers=[],this.code="",this.showCodeModal=!1,this.selectedLink=null,this.showProviderDetail=!1,this.selectedProvider=null,this.newProviderSharing={share_bp:!1,share_glucose:!1,share_spo2:!1,share_hr:!1,share_pain:!1,share_weight:!1}}ngOnInit(){return x(this,null,function*(){yield this.loadProviders()})}loadProviders(){return x(this,null,function*(){let a=this.authService.getCurrentUser();if(!a)return;let{data:e}=yield this.sharingService.getPatientLinks(a.id);e&&(this.providers=yield Promise.all(e.map(i=>x(this,null,function*(){let{data:P}=yield this.profileService.getProfile(i.provider_id);return y(N({},i),{providerProfile:P})}))))})}shareViaOS(){return x(this,null,function*(){if(navigator.share)try{yield navigator.share({title:"VitaLink Invitation",text:"Join me on VitaLink to track my health data",url:window.location.origin})}catch{}})}showAddProviderModal(){this.code="",this.showCodeModal=!0}redeemCode(){return x(this,null,function*(){if(this.code.length!==6){yield(yield this.toastController.create({message:"Please enter a 6-digit code",duration:2e3,color:"danger"})).present();return}let a=this.authService.getCurrentUser();if(!a)return;let{data:e,error:i}=yield this.sharingService.redeemToken(this.code,a.id);i?yield(yield this.toastController.create({message:i.message||"Invalid or expired code",duration:3e3,color:"danger"})).present():(e&&(yield this.sharingService.updateSharing(e.id,this.newProviderSharing)),this.showCodeModal=!1,this.newProviderSharing={share_bp:!1,share_glucose:!1,share_spo2:!1,share_hr:!1,share_pain:!1,share_weight:!1},yield this.loadProviders(),yield(yield this.toastController.create({message:"Provider added successfully",duration:2e3,color:"success"})).present())})}showProviderDetails(a){this.selectedProvider=a,this.showProviderDetail=!0}updateSharing(a,e,i){return x(this,null,function*(){let P={[e]:i};yield this.sharingService.updateSharing(a,P),yield this.loadProviders()})}revokeAccess(a){return x(this,null,function*(){yield(yield this.alertController.create({header:"Revoke Access",message:"Are you sure you want to revoke access for this provider?",buttons:[{text:"Cancel",role:"cancel"},{text:"Revoke",role:"destructive",handler:()=>x(this,null,function*(){yield this.sharingService.revokeLink(a.id),yield this.loadProviders()})}]})).present()})}formatDate(a){return a?new Date(a).toLocaleDateString():""}};v.\u0275fac=function(e){return new(e||v)(E($),E(ie),E(te),E(q),E(Y))},v.\u0275cmp=M({type:v,selectors:[["app-patient-connect"]],decls:30,vars:24,consts:[[3,"translucent"],[1,"ion-padding",3,"fullscreen"],[1,"connect-container"],[1,"connect-header"],["expand","block",1,"ion-margin-top",3,"click"],["expand","block","fill","outline",1,"ion-margin-top",3,"click"],[1,"providers-list","ion-margin-top"],[4,"ngIf"],["color","medium",4,"ngIf"],[3,"didDismiss","isOpen"],["button","",3,"click",4,"ngFor","ngForOf"],["button","",3,"click"],["color","medium"],["slot","end"],[3,"click"],[1,"ion-padding"],[3,"codeChange","codeComplete","code"],[1,"sharing-options","ion-margin-top"],[3,"ngModelChange","ngModel"],["expand","block",1,"ion-margin-top",3,"click","disabled"],["class","ion-padding",4,"ngIf"],[1,"provider-detail"],[1,"ion-margin-top"],[3,"ionChange","checked"],["expand","block","color","danger",1,"ion-margin-top",3,"click"]],template:function(e,i){e&1&&(o(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),l(3),s(4,"translate"),r()()(),o(5,"ion-content",1)(6,"div",2)(7,"div",3)(8,"h2"),l(9),s(10,"translate"),r(),o(11,"p"),l(12),s(13,"translate"),r()(),o(14,"ion-button",4),h("click",function(){return i.shareViaOS()}),l(15),s(16,"translate"),r(),o(17,"ion-button",5),h("click",function(){return i.showAddProviderModal()}),l(18),s(19,"translate"),r(),o(20,"div",6)(21,"h3"),l(22),s(23,"translate"),r(),I(24,oe,2,1,"ion-list",7)(25,ae,3,3,"ion-text",8),r()(),o(26,"ion-modal",9),h("didDismiss",function(){return i.showCodeModal=!1}),I(27,le,51,41,"ng-template"),r(),o(28,"ion-modal",9),h("didDismiss",function(){return i.showProviderDetail=!1}),I(29,de,9,6,"ng-template"),r()()),e&2&&(C("translucent",!0),n(3),p(d(4,12,"CONNECT.TITLE")),n(2),C("fullscreen",!0),n(4),p(d(10,14,"CONNECT.TITLE")),n(3),p(d(13,16,"CONNECT.SUBTITLE")),n(3),u(" ",d(16,18,"CONNECT.SHARE_VIA_OS")," "),n(3),u(" ",d(19,20,"CONNECT.ADD_CARETAKER")," "),n(4),p(d(23,22,"CONNECT.MY_PROVIDERS")),n(2),C("ngIf",i.providers.length>0),n(),C("ngIf",i.providers.length===0),n(),C("isOpen",i.showCodeModal),n(2),C("isOpen",i.showProviderDetail))},dependencies:[V,k,b,A,B,D,H,F,z,J,W,L,G,j,U,K,Q,R,Z,ee,X],styles:[".connect-container[_ngcontent-%COMP%]{max-width:600px;margin:0 auto}.connect-header[_ngcontent-%COMP%]{margin-bottom:2rem}.connect-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;margin-bottom:.5rem}.connect-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ion-text-color);opacity:.7}.providers-list[_ngcontent-%COMP%]{margin-top:2rem}.providers-list[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600;margin-bottom:1rem}.sharing-options[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .provider-detail[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;margin-bottom:1rem}"]});let _=v;return _})();export{fe as PatientConnectPage};
