import{a as q}from"./chunk-UFNSOT4R.js";import{a as H}from"./chunk-BRRUA5UT.js";import{a as $}from"./chunk-ZL5SRYO7.js";import{a as z}from"./chunk-B3MTCGZB.js";import"./chunk-7VI3B7OV.js";import{b as f}from"./chunk-FEUMV7UB.js";import{$ as j,Aa as R,Ba as F,Ea as U,F as a,Fa as J,G as p,J as b,K as _,Ka as V,L,M as m,N as d,Oa as W,Pa as X,Q as y,W as O,_ as N,ba as k,f as C,g as I,l as c,n as g,o as w,oa as M,pa as P,qa as B,r as x,ra as G,s as i,sa as A,t as o,va as D,z as h}from"./chunk-IPUYINSA.js";import"./chunk-QFN5WVFN.js";import"./chunk-7KGURMOZ.js";import"./chunk-C6GHFGSM.js";import"./chunk-4BHFLD23.js";import"./chunk-MFJQPCIH.js";import"./chunk-PGY34PD4.js";import"./chunk-GYLY2RJE.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-2F44PKVT.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{g as S}from"./chunk-2R6CW7ES.js";function K(s){let r=["Date","Time","Metric","Value","Systolic","Diastolic","Unit","Tags"],T=s.map(e=>{let n=new Date(e.ts),u=n.toLocaleDateString(),l=n.toLocaleTimeString(),v="";return e.metric==="bp"?v=`${e.systolic}/${e.diastolic}`:v=e.numeric_value?.toString()||"",[u,l,e.metric,v,e.systolic?.toString()||"",e.diastolic?.toString()||"",e.unit||"",e.tags?.join("; ")||""]});return[r,...T].map(e=>e.map(n=>`"${n}"`).join(",")).join(`
`)}function Q(s){return JSON.stringify(s,null,2)}function E(s,r,T){let t=new Blob([s],{type:T}),e=document.createElement("a");e.href=URL.createObjectURL(t),e.download=r,e.click(),URL.revokeObjectURL(e.href)}var Y=(()=>{let r=class r{constructor(t,e){this.observationService=t,this.authService=e}exportToCSV(){return S(this,null,function*(){let t=this.authService.getCurrentUser();if(!t)return{error:new Error("Not authenticated")};let{data:e,error:n}=yield this.observationService.getAllObservations(t.id,1e4);if(n||!e)return{error:n};let u=K(e),l=`vitalink-export-${new Date().toISOString().split("T")[0]}.csv`;return E(u,l,"text/csv;charset=utf-8;"),{}})}exportToJSON(){return S(this,null,function*(){let t=this.authService.getCurrentUser();if(!t)return{error:new Error("Not authenticated")};let{data:e,error:n}=yield this.observationService.getAllObservations(t.id,1e4);if(n||!e)return{error:n};let u=Q(e),l=`vitalink-export-${new Date().toISOString().split("T")[0]}.json`;return E(u,l,"application/json;charset=utf-8;"),{}})}};r.\u0275fac=function(e){return new(e||r)(I(H),I(f))},r.\u0275prov=C({token:r,factory:r.\u0275fac,providedIn:"root"});let s=r;return s})();var Te=(()=>{let r=class r{constructor(t,e,n,u,l,v,Z,ee){this.authService=t,this.profileService=e,this.i18nService=n,this.exportService=u,this.reminderService=l,this.router=v,this.toastController=Z,this.alertController=ee,this.profile=null,this.currentLanguage="en"}ngOnInit(){return S(this,null,function*(){this.profile=yield this.authService.getCurrentProfile(),this.currentLanguage=this.i18nService.getCurrentLanguage()})}changeLanguage(t){return S(this,null,function*(){if(this.i18nService.setLanguage(t),this.currentLanguage=t,this.profile){let{error:e}=yield this.profileService.updateProfile(this.profile.id,{language:t});e&&(yield(yield this.toastController.create({message:"Failed to update language",duration:2e3,color:"danger"})).present())}})}exportCSV(){return S(this,null,function*(){let{error:t}=yield this.exportService.exportToCSV();t?yield(yield this.toastController.create({message:"Export failed",duration:2e3,color:"danger"})).present():yield(yield this.toastController.create({message:"Export successful",duration:2e3,color:"success"})).present()})}exportJSON(){return S(this,null,function*(){let{error:t}=yield this.exportService.exportToJSON();t?yield(yield this.toastController.create({message:"Export failed",duration:2e3,color:"danger"})).present():yield(yield this.toastController.create({message:"Export successful",duration:2e3,color:"success"})).present()})}logout(){return S(this,null,function*(){yield(yield this.alertController.create({header:"Logout",message:"Are you sure you want to logout?",buttons:[{text:"Cancel",role:"cancel"},{text:"Logout",role:"destructive",handler:()=>S(this,null,function*(){yield this.authService.signOut(),this.router.navigate(["/auth"])})}]})).present()})}};r.\u0275fac=function(e){return new(e||r)(g(f),g($),g(q),g(Y),g(z),g(O),g(J),g(U))},r.\u0275cmp=w({type:r,selectors:[["app-settings"]],decls:67,vars:33,consts:[[3,"translucent"],[3,"fullscreen"],["button","","routerLink","/tabs/settings/profile"],["button","","routerLink","/tabs/settings/reminders"],[3,"ngModelChange","ionChange","ngModel"],["value","en"],["value","es"],["value","fr"],["value","de"],["value","ar"],["value","fa"],["value","ur"],["button","","routerLink","/tabs/settings/mode-switch"],["button","","routerLink","/tabs/settings/about"],["button","",3,"click"]],template:function(e,n){e&1&&(i(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),a(3),m(4,"translate"),o()()(),i(5,"ion-content",1)(6,"ion-list")(7,"ion-item",2)(8,"ion-label")(9,"h2"),a(10),m(11,"translate"),o()()(),i(12,"ion-item",3)(13,"ion-label")(14,"h2"),a(15),m(16,"translate"),o()()(),i(17,"ion-item")(18,"ion-label")(19,"h2"),a(20),m(21,"translate"),o()(),i(22,"ion-select",4),L("ngModelChange",function(l){return _(n.currentLanguage,l)||(n.currentLanguage=l),l}),h("ionChange",function(l){return n.changeLanguage(l.detail.value)}),i(23,"ion-select-option",5),a(24,"English"),o(),i(25,"ion-select-option",6),a(26,"Espa\xF1ol"),o(),i(27,"ion-select-option",7),a(28,"Fran\xE7ais"),o(),i(29,"ion-select-option",8),a(30,"Deutsch"),o(),i(31,"ion-select-option",9),a(32,"\u0627\u0644\u0639\u0631\u0628\u064A\u0629"),o(),i(33,"ion-select-option",10),a(34,"\u0641\u0627\u0631\u0633\u06CC"),o(),i(35,"ion-select-option",11),a(36,"\u0627\u0631\u062F\u0648"),o()()(),i(37,"ion-item",12)(38,"ion-label")(39,"h2"),a(40),m(41,"translate"),o()()(),i(42,"ion-item",13)(43,"ion-label")(44,"h2"),a(45),m(46,"translate"),o()()(),i(47,"ion-item")(48,"ion-label")(49,"h2"),a(50),m(51,"translate"),o()()(),i(52,"ion-item",14),h("click",function(){return n.exportCSV()}),i(53,"ion-label")(54,"p"),a(55),m(56,"translate"),o()()(),i(57,"ion-item",14),h("click",function(){return n.exportJSON()}),i(58,"ion-label")(59,"p"),a(60),m(61,"translate"),o()()(),i(62,"ion-item",14),h("click",function(){return n.logout()}),i(63,"ion-label")(64,"h2"),a(65),m(66,"translate"),o()()()()()),e&2&&(x("translucent",!0),c(3),p(d(4,13,"SETTINGS.TITLE")),c(2),x("fullscreen",!0),c(5),p(d(11,15,"SETTINGS.PROFILE")),c(5),p(d(16,17,"SETTINGS.REMINDERS")),c(5),p(d(21,19,"SETTINGS.LANGUAGE")),c(2),b("ngModel",n.currentLanguage),c(18),p(d(41,21,"SETTINGS.SWITCH_MODE")),c(5),p(d(46,23,"SETTINGS.ABOUT")),c(5),p(d(51,25,"SETTINGS.EXPORT_DATA")),c(5),p(d(56,27,"SETTINGS.EXPORT_CSV")),c(5),p(d(61,29,"SETTINGS.EXPORT_JSON")),c(5),p(d(66,31,"SETTINGS.LOGOUT")))},dependencies:[y,k,N,j,M,P,R,F,A,B,G,V,D,X,W],styles:["ion-list[_ngcontent-%COMP%]{padding:0}"]});let s=r;return s})();export{Te as SettingsPage};
