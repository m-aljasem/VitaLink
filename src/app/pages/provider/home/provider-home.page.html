<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>{{ 'APP_NAME' | translate }}</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-refresher slot="fixed" (ionRefresh)="doRefresh($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>

  <div class="provider-home-container ion-padding">
    <div class="greeting">
      <h1>{{ 'HOME.GREETING_MORNING' | translate }}, {{ profile?.first_name || 'Provider' }}</h1>
    </div>

    <!-- Stats Widgets -->
    <div class="stats-grid">
      <ion-card>
        <ion-card-header>
          <ion-card-title>{{ stats.totalPatients }}</ion-card-title>
        </ion-card-header>
        <ion-card-content>
          <p>{{ 'PROVIDER.STATS_PATIENTS' | translate }}</p>
        </ion-card-content>
      </ion-card>

      <ion-card>
        <ion-card-header>
          <ion-card-title>{{ stats.activeThisWeek }}</ion-card-title>
        </ion-card-header>
        <ion-card-content>
          <p>{{ 'PROVIDER.STATS_ACTIVE' | translate }}</p>
        </ion-card-content>
      </ion-card>

      <ion-card>
        <ion-card-header>
          <ion-card-title>{{ stats.newLinks }}</ion-card-title>
        </ion-card-header>
        <ion-card-content>
          <p>{{ 'PROVIDER.STATS_NEW' | translate }}</p>
        </ion-card-content>
      </ion-card>

      <ion-card>
        <ion-card-header>
          <ion-card-title>{{ stats.exceptions }}</ion-card-title>
        </ion-card-header>
        <ion-card-content>
          <p>{{ 'PROVIDER.STATS_EXCEPTIONS' | translate }}</p>
        </ion-card-content>
      </ion-card>
    </div>

    <!-- Patients List -->
    <div class="patients-section">
      <h2>{{ 'PROVIDER.PATIENT_DETAIL' | translate }}</h2>
      
      <ion-list *ngIf="patients.length > 0">
        <ion-item button *ngFor="let patient of patients" (click)="navigateToPatient(patient.profile.id)">
          <ion-label>
            <h3>{{ patient.profile.first_name }} {{ patient.profile.last_name }}</h3>
            <p>{{ 'PROVIDER.LAST_SEEN' | translate }}: {{ formatDate(patient.lastSeen) }}</p>
            <div class="shared-metrics">
              <ion-chip *ngFor="let metric of patient.sharedMetrics" size="small">
                {{ 'METRICS.' + metric.toUpperCase() | translate }}
              </ion-chip>
            </div>
          </ion-label>
        </ion-item>
      </ion-list>

      <ion-text *ngIf="patients.length === 0" color="medium">
        {{ 'CONNECT.NO_PROVIDERS' | translate }}
      </ion-text>
    </div>
  </div>
</ion-content>

